---
title: "Covid19 deaths in the US by state"
author: "bat"
date: "9/13/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Strategy: 
  - Demonstrate how to get data from an internet source 
  - do some data wrangling and simple statistical analysis 
  - plot results

Firstly, if anything goes wrong, it might have to do with differences in the version of R. I'm running R version 4.0.5 (2021-03-31) -- "Shake and Throw". Platform: x86_64-w64-mingw32/x64 (64-bit)

Let's calculate some statistics about deaths from Covid-19 based on CDC data:
<https://data.cdc.gov/NCHS/Provisional-COVID-19-Deaths-by-Sex-and-Age/9bhg-hcku>

## step 1:
On the CDC page click on the EXPORT button on the top right of the page to download the csv file called 'Provisional_COVID-19_Death_Counts_by_Sex__Age.csv'
download it to your desktop or another folder and copy the path to the file

## step 2:
Open R studio and click on File -> New File -> Rscript 

You will need some packages so either use the "install.packages()" function, i.e. install.packages(c("tidyverse", "magrittr"))

**or** the easier way is to go to the right-side window of Rstudio where it shows tabs for Files-Plots-Packages-Help-Viewer, and click on Packages. 
Underneath there is a button for "Install". Click install and type in the names of the packages: "magrittr" , "tidyverse". These only have to be installed once until there is an update.

## step 3:
Load the libraries: this has to be done every time the script is run

**magrittr** is for piping - explained later but just so you know the %>% in R is called a pipe. You know the picture by Rene Magritte? of the pipe? 
**tidyverse** contains many functions for data wrangling

```{r , echo=TRUE}
library(magrittr) 
library(tidyverse) 
```

## step 4 
Load the dataset using the read.csv() or read.table() function

*NOTE:* the path to your file needs forward slashes / for R not back slashes like windows uses
Change the path in the read.table() function to where your file is located

read.csv() is the same function but assumes that the file is comma delimited
str() is a very important function that shows the structure of the data file
head() shows the first n rows of data

```{r , echo=TRUE}
covidDeaths <- read.table(file="C:/Users/User/Documents/PersonalWebsite/bonniethiel/content/post/Covid19-deaths/Provisional_COVID-19_Deaths_by_Sex_and_Age.csv", sep=",", header=TRUE) 
str(covidDeaths)
head(covidDeaths, n=5)
```

# ASIDE: 
*Another really awesome way to get the data is by using the CDC API. Follow the CDC instructions for getting an account to request an API token.*
*Then use this code:*

*install.packages("RSocrata")*
*library("RSocrata")*

*df <- read.socrata(*
  *"https://data.cdc.gov/resource/9bhg-hcku.json",*
  *app_token = "YOURAPPTOKENHERE",*
  *email     = "user@example.com",*
  *password  = "fakepassword"*
*)*



## step 5 

Look at some of the variables to get a handle on what we've got:
```{r }
table(covidDeaths$Sex) 
```

```{r }
table(covidDeaths$Age.group) 
```

See how the table() function works? Tell it what variable you want to see a table for and it will give you the frequency of each category




## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
