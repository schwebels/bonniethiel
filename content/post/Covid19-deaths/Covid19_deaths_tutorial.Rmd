---
title: "Covid19 deaths in the US by state"
author: Bonnie Thiel
date: 2021-09-15T21:13:14-05:00
categories: ["R"]
tags: ["R Markdown", "plot", "descriptive stats"]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

START

# Strategy: 
  - Demonstrate how to get data from an internet source 
  - do some data wrangling and simple statistical analysis 
  - plot results


Let's calculate some statistics about deaths from Covid-19 based on CDC data:
<https://data.cdc.gov/NCHS/Provisional-COVID-19-Deaths-by-Sex-and-Age/9bhg-hcku>

## step 1:
On the CDC page click on the EXPORT button on the top right of the page to download the csv file called 'Provisional_COVID-19_Death_Counts_by_Sex__Age.csv'
download it to your desktop or another folder and copy the path to the clipboard

## step 2:
Open R studio and click on File -> New File -> Rscript 

You will need some packages so either use the "install.packages()" function, i.e. install.packages(c("tidyverse", "magrittr"))

**or** the easier way is to go to the right-side window of Rstudio where it shows tabs for Files-Plots-Packages-Help-Viewer, and click on Packages. 
Underneath there is a button for "Install". Click install and type in the names of the packages: "magrittr" , "tidyverse". These only have to be installed once until there is an update.

## step 3:
Load the libraries: this has to be done every time the script is run

**magrittr** is for piping - explained later but just so you know the %>% in R is called a pipe. You know the picture by Rene Magritte? of the pipe? 
**tidyverse** contains many functions for data wrangling

```{r , echo=TRUE}
library(magrittr) 
library(tidyverse) 
```

## step 4 
Load the dataset using the read.csv() or read.table() function

*NOTE:* the path to your file needs forward slashes / for R not back slashes like windows uses
Copy the path from the clipboard in the read.table() function so that R knows where to find your data

read.csv() is the same function but assumes that the file is comma delimited
str() is a very important function that shows the structure of the data file
head() shows the first n rows of data

```{r , echo=TRUE}
covidDeaths <- read.table(file="C:/Users/User/Documents/PersonalWebsite/bonniethiel/content/post/Covid19-deaths/Provisional_COVID-19_Deaths_by_Sex_and_Age.csv", sep=",", header=TRUE) 
str(covidDeaths)
head(covidDeaths, n=5)
```


## step 5 

Look at some of the variables to get a handle on what we've got:
```{r }
table(covidDeaths$Sex) 
```

```{r }
table(covidDeaths$Age.Group) 
```

If you can see the table frequencies then everything seems to be working so let's move on to data wrangling


# FILTER 
if you want to filter to a specific group to calculate the deaths, there are many, *many* ways in R. I think the best way is to use the functions from "tidyverse" along with "magrittr" which allows you to string together commands:

for example, to get only the numbers for males and females 18-29 years:
```{r , echo=TRUE}
covidDeaths.MF.18to29 <- covidDeaths %>% filter(Age.Group == "18-29 years" & Sex %in% (c("Male", "Female")))
head(covidDeaths.MF.18to29)
```

The '<-' symbol is prounounced 'gets' and the %>% is a pipe from the magrittr package and is called 'and then' so the syntax in words is:

#covidDeaths.MF.18to29 'gets' covidDeaths object 'and then' filters to Age.group= 18-29 and Male or Female sex. **Remember to use '==' not just '='**

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
