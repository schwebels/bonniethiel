---
title: "Covid19 deaths in the US by state"
author: "bat"
date: "9/13/2021"
output: html_document
---



<div id="strategy" class="section level1">
<h1>Strategy:</h1>
<ul>
<li>Demonstrate how to get data from an internet source</li>
<li>do some data wrangling and simple statistical analysis</li>
<li>plot results</li>
</ul>
<p>Firstly, if anything goes wrong, it might have to do with differences in the version of R. I’m running R version 4.0.5 (2021-03-31) – “Shake and Throw”. Platform: x86_64-w64-mingw32/x64 (64-bit)</p>
<p>Let’s calculate some statistics about deaths from Covid-19 based on CDC data:
<a href="https://data.cdc.gov/NCHS/Provisional-COVID-19-Deaths-by-Sex-and-Age/9bhg-hcku" class="uri">https://data.cdc.gov/NCHS/Provisional-COVID-19-Deaths-by-Sex-and-Age/9bhg-hcku</a></p>
<div id="step-1" class="section level2">
<h2>step 1:</h2>
<p>On the CDC page click on the EXPORT button on the top right of the page to download the csv file called ’Provisional_COVID-19_Death_Counts_by_Sex__Age.csv’
download it to your desktop or another folder and copy the path to the file</p>
</div>
<div id="step-2" class="section level2">
<h2>step 2:</h2>
<p>Open R studio and click on File -&gt; New File -&gt; Rscript</p>
<p>You will need some packages so either use the “install.packages()” function, i.e. install.packages(c(“tidyverse”, “magrittr”))</p>
<p><strong>or</strong> the easier way is to go to the right-side window of Rstudio where it shows tabs for Files-Plots-Packages-Help-Viewer, and click on Packages.
Underneath there is a button for “Install”. Click install and type in the names of the packages: “magrittr” , “tidyverse”. These only have to be installed once until there is an update.</p>
</div>
<div id="step-3" class="section level2">
<h2>step 3:</h2>
<p>Load the libraries: this has to be done every time the script is run</p>
<p><strong>magrittr</strong> is for piping - explained later but just so you know the %&gt;% in R is called a pipe. You know the picture by Rene Magritte? of the pipe?
<strong>tidyverse</strong> contains many functions for data wrangling</p>
<pre class="r"><code>library(magrittr) 
library(tidyverse) </code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v ggplot2 3.3.2     v purrr   0.3.4
## v tibble  3.0.4     v dplyr   1.0.2
## v tidyr   1.1.2     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.0</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x tidyr::extract()   masks magrittr::extract()
## x dplyr::filter()    masks stats::filter()
## x dplyr::lag()       masks stats::lag()
## x purrr::set_names() masks magrittr::set_names()</code></pre>
</div>
<div id="step-4" class="section level2">
<h2>step 4</h2>
<p>Load the dataset using the read.csv() or read.table() function</p>
<p><em>NOTE:</em> the path to your file needs forward slashes / for R not back slashes like windows uses
Change the path in the read.table() function to where your file is located</p>
<p>read.csv() is the same function but assumes that the file is comma delimited
str() is a very important function that shows the structure of the data file
head() shows the first n rows of data</p>
<pre class="r"><code>covidDeaths &lt;- read.table(file=&quot;C:/Users/User/Documents/PersonalWebsite/bonniethiel/content/post/Covid19-deaths/Provisional_COVID-19_Deaths_by_Sex_and_Age.csv&quot;, sep=&quot;,&quot;, header=TRUE) 
str(covidDeaths)</code></pre>
<pre><code>## &#39;data.frame&#39;:    66096 obs. of  16 variables:
##  $ Data.As.Of                              : chr  &quot;09/08/2021&quot; &quot;09/08/2021&quot; &quot;09/08/2021&quot; &quot;09/08/2021&quot; ...
##  $ Start.Date                              : chr  &quot;01/01/2020&quot; &quot;01/01/2020&quot; &quot;01/01/2020&quot; &quot;01/01/2020&quot; ...
##  $ End.Date                                : chr  &quot;09/04/2021&quot; &quot;09/04/2021&quot; &quot;09/04/2021&quot; &quot;09/04/2021&quot; ...
##  $ Group                                   : chr  &quot;By Total&quot; &quot;By Total&quot; &quot;By Total&quot; &quot;By Total&quot; ...
##  $ Year                                    : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ Month                                   : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ State                                   : chr  &quot;United States&quot; &quot;United States&quot; &quot;United States&quot; &quot;United States&quot; ...
##  $ Sex                                     : chr  &quot;All Sexes&quot; &quot;All Sexes&quot; &quot;All Sexes&quot; &quot;All Sexes&quot; ...
##  $ Age.Group                               : chr  &quot;All Ages&quot; &quot;Under 1 year&quot; &quot;0-17 years&quot; &quot;1-4 years&quot; ...
##  $ COVID.19.Deaths                         : int  643858 98 412 50 138 1232 3043 5395 8634 13567 ...
##  $ Total.Deaths                            : int  5507901 31347 55352 5798 9259 59389 104738 123138 150055 177545 ...
##  $ Pneumonia.Deaths                        : int  583698 336 924 187 270 1317 3071 5042 7728 11823 ...
##  $ Pneumonia.and.COVID.19.Deaths           : int  320617 12 93 10 40 496 1367 2551 4167 6714 ...
##  $ Influenza.Deaths                        : int  9272 22 188 65 80 80 148 236 324 366 ...
##  $ Pneumonia..Influenza..or.COVID.19.Deaths: int  914900 444 1431 292 448 2128 4883 8104 12494 19003 ...
##  $ Footnote                                : chr  &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...</code></pre>
<pre class="r"><code>head(covidDeaths, n=5)</code></pre>
<pre><code>##   Data.As.Of Start.Date   End.Date    Group Year Month         State       Sex
## 1 09/08/2021 01/01/2020 09/04/2021 By Total   NA    NA United States All Sexes
## 2 09/08/2021 01/01/2020 09/04/2021 By Total   NA    NA United States All Sexes
## 3 09/08/2021 01/01/2020 09/04/2021 By Total   NA    NA United States All Sexes
## 4 09/08/2021 01/01/2020 09/04/2021 By Total   NA    NA United States All Sexes
## 5 09/08/2021 01/01/2020 09/04/2021 By Total   NA    NA United States All Sexes
##      Age.Group COVID.19.Deaths Total.Deaths Pneumonia.Deaths
## 1     All Ages          643858      5507901           583698
## 2 Under 1 year              98        31347              336
## 3   0-17 years             412        55352              924
## 4    1-4 years              50         5798              187
## 5   5-14 years             138         9259              270
##   Pneumonia.and.COVID.19.Deaths Influenza.Deaths
## 1                        320617             9272
## 2                            12               22
## 3                            93              188
## 4                            10               65
## 5                            40               80
##   Pneumonia..Influenza..or.COVID.19.Deaths Footnote
## 1                                   914900         
## 2                                      444         
## 3                                     1431         
## 4                                      292         
## 5                                      448</code></pre>
</div>
</div>
<div id="aside" class="section level1">
<h1>ASIDE:</h1>
<p><em>Another really awesome way to get the data is by using the CDC API. Follow the CDC instructions for getting an account to request an API token.</em>
<em>Then use this code:</em></p>
<p><em>install.packages(“RSocrata”)</em>
<em>library(“RSocrata”)</em></p>
<p><em>df &lt;- read.socrata(</em>
<em>“<a href="https://data.cdc.gov/resource/9bhg-hcku.json" class="uri">https://data.cdc.gov/resource/9bhg-hcku.json</a>”,</em>
<em>app_token = “YOURAPPTOKENHERE”,</em>
<em>email = “<a href="mailto:user@example.com" class="email">user@example.com</a>”,</em>
<em>password = “fakepassword”</em>
<em>)</em></p>
<div id="step-5" class="section level2">
<h2>step 5</h2>
<p>Look at some of the variables to get a handle on what we’ve got:</p>
<pre class="r"><code>table(covidDeaths$Sex) </code></pre>
<pre><code>## 
## All Sexes    Female      Male 
##     22032     22032     22032</code></pre>
<pre class="r"><code>table(covidDeaths$Age.group) </code></pre>
<pre><code>## &lt; table of extent 0 &gt;</code></pre>
<p>See how the table() function works? Tell it what variable you want to see a table for and it will give you the frequency of each category</p>
</div>
<div id="including-plots" class="section level2">
<h2>Including Plots</h2>
<p>You can also embed plots, for example:</p>
<p><img src="/post/Covid19-deaths/Covid19_deaths_tutorial_files/figure-html/pressure-1.png" width="672" /></p>
<p>Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot.</p>
</div>
</div>
